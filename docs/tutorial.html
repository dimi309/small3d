<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The small3d library: small3d Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_s.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The small3d library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">small3d Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is a tutorial on creating a ball in Blender, and then writing a C++ program that loads it and moves it around on the screen, using small3d. Alternatively you can skip the ball creation and use a model of your own, if you have one in a glTF .glb file. The source code for this tutorial can be found here: <a href="https://github.com/dimi309/ball">https://github.com/dimi309/ball</a></p>
<h1><a class="anchor" id="autotoc_md13"></a>
Getting small3d and Blender</h1>
<p>The first thing to do is to download small3d from GitHub: <a href="https://github.com/dimi309/small3d">https://github.com/dimi309/small3d</a>​​ Just follow the instructions in the README file to build it. If you have or can find a glTF .glb file containing a model somewhere, you can use that for the tutorial. Just skip to section "CMake Setup". Otherwise you need to install Blender since this tutorial begins with creating a model of a ball: <a href="https://www.blender.org/">https://www.blender.org/</a></p>
<h1><a class="anchor" id="autotoc_md14"></a>
Creating a 3D Model with Blender</h1>
<p>When you start Blender, you see a cube, and probably a camera:</p>
<p><img src="tutorial01.png" alt="" class="inline" title="blender-start"/>   </p>
<p>Press a to select them. If they are selected already, pressing a will de-select them. Press it again in that case. Then x to delete everything. You will be asked to confirm the deletion:</p>
<p><img src="tutorial02.png" alt="" class="inline" title="confirm-deletion"/>   </p>
<p>Just press enter to do so. Then, from the menu, select Add &gt; Mesh &gt; UV Sphere:</p>
<p><img src="tutorial03.png" alt="" class="inline" title="add-uv-sphere"/>   </p>
<p>This will create, as it says, a sphere:</p>
<p><img src="tutorial04.png" alt="" class="inline" title="uv-sphere"/>   </p>
<p>With the sphere selected (use the a key if it is not), select Object &gt; Shade Smooth from the menu:</p>
<p><img src="tutorial05.png" alt="" class="inline" title="select-smooth-shading"/>   </p>
<p>This is not important but it will make the sphere look better. We now need to create the Wavefront file. From the menu at the top, select File &gt; Export &gt; glTF 2.0 (.glb/.gltf):</p>
<p><img src="tutorial06.png" alt="" class="inline" title="export-gltf"/>   </p>
<p>Save the exported file as ball.obj (name it and click on the Export OBJ button):</p>
<p><img src="tutorial07.png" alt="" class="inline" title="save-model"/>   </p>
<h1><a class="anchor" id="autotoc_md15"></a>
CMake Setup</h1>
<p>Let's proceed to make our first program. Note that, instead of writing all the CMake code below, we could have just created a Visual Studio project for example, adding the small3d library and dependencies to it. But using CMake as described will truly make our demo cross-platform, being able to compile and run on Windows, MacOS or Linux.</p>
<p>Create a directory, called ball. Then create another directory within it, called resources and place ball.obj in it. Also add the following code to a CMakeFiles.txt within the ball directory:</p>
<div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.0.2)</div>
<div class="line"> </div>
<div class="line">project(ball)</div>
<div class="line"> </div>
<div class="line">file(COPY &quot;resources&quot; DESTINATION &quot;${PROJECT_BINARY_DIR}/bin&quot;)</div>
<div class="line">file(COPY &quot;deps/shaders&quot; DESTINATION &quot;${PROJECT_BINARY_DIR}/bin/resources&quot;)</div>
<div class="line"> </div>
<div class="line">set(CMAKE_RUNTIME_OUTPUT_DIRECTORY &quot;${PROJECT_BINARY_DIR}/bin&quot;)</div>
<div class="line"> </div>
<div class="line">set(CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/deps/cmake)</div>
<div class="line"> </div>
<div class="line">if(MSVC)</div>
<div class="line">  set(CMAKE_RUNTIME_OUTPUT_DIRECTORY_DEBUG &quot;${PROJECT_BINARY_DIR}/bin&quot;)</div>
<div class="line">  set(CMAKE_RUNTIME_OUTPUT_DIRECTORY_RELEASE &quot;${PROJECT_BINARY_DIR}/bin&quot;)</div>
<div class="line">endif(MSVC)</div>
<div class="line"> </div>
<div class="line">set(DEPS_PATH &quot;${CMAKE_SOURCE_DIR}/deps&quot;)</div>
<div class="line">set(CMAKE_PREFIX_PATH ${DEPS_PATH})</div>
<div class="line"> </div>
<div class="line">find_package(SMALL3D REQUIRED)</div>
<div class="line"> </div>
<div class="line">subdirs(src)</div>
</div><!-- fragment --><p>Create a directory called src within the ball directory and, inside it, another CMakeLists.txt file:</p>
<div class="fragment"><div class="line">add_executable(ball main.cpp)</div>
<div class="line"> </div>
<div class="line">target_include_directories(ball PUBLIC &quot;${CMAKE_SOURCE_DIR}/include&quot;)</div>
<div class="line"> </div>
<div class="line">target_include_directories(ball PUBLIC ${SMALL3D_INCLUDE_DIRS})</div>
<div class="line"> </div>
<div class="line">target_link_libraries(ball PUBLIC ${SMALL3D_LIBRARIES})</div>
<div class="line"> </div>
<div class="line">if(APPLE)</div>
<div class="line">  set_target_properties(ball PROPERTIES LINK_FLAGS &quot;-framework \</div>
<div class="line">        AudioUnit -framework AudioToolbox -framework CoreAudio -framework Cocoa \</div>
<div class="line">        -framework IOKit -framework CoreVideo&quot;)</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line">if(MSVC)</div>
<div class="line">  set_target_properties(ball PROPERTIES VS_DEBUGGER_WORKING_DIRECTORY</div>
<div class="line">    &quot;${PROJECT_BINARY_DIR}/bin&quot;)</div>
<div class="line">endif()</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md16"></a>
The Code</h1>
<p>Inside ball/src, create the main.cpp file:</p>
<div class="fragment"><div class="line">int main(int argc, char **argv) {</div>
<div class="line"> </div>
<div class="line"> return 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Include small3d's Renderer and SceneObject classes:</p>
<div class="fragment"><div class="line">#include &lt;small3d/Renderer.hpp&gt;</div>
<div class="line">#include &lt;small3d/SceneObject.hpp&gt;</div>
</div><!-- fragment --><p>Now we need the GLFW header files:</p>
<div class="fragment"><div class="line">#include &lt;GLFW/glfw3.h&gt;</div>
</div><!-- fragment --><p>We also need to be using the small3d namespace, so this goes under our include statements:</p>
<div class="fragment"><div class="line">using namespace small3d;</div>
</div><!-- fragment --><p>We also need to write the logic that will be detecting key presses:</p>
<div class="fragment"><div class="line">bool downkey, leftkey, rightkey, upkey, esckey;</div>
<div class="line"> </div>
<div class="line">void keyCallback(GLFWwindow* window, int key, int scancode, int action,</div>
<div class="line"> int mods)</div>
<div class="line">{</div>
<div class="line">if (key == GLFW_KEY_DOWN &amp;&amp; action == GLFW_PRESS)</div>
<div class="line">     downkey = true;</div>
<div class="line">if (key == GLFW_KEY_UP &amp;&amp; action == GLFW_PRESS)</div>
<div class="line">     upkey = true;</div>
<div class="line">if (key == GLFW_KEY_LEFT &amp;&amp; action == GLFW_PRESS)</div>
<div class="line">     leftkey = true;</div>
<div class="line">if (key == GLFW_KEY_RIGHT &amp;&amp; action == GLFW_PRESS)</div>
<div class="line">     rightkey = true;</div>
<div class="line">if (key == GLFW_KEY_ESCAPE &amp;&amp; action == GLFW_PRESS)</div>
<div class="line">     esckey = true;</div>
<div class="line">if (key == GLFW_KEY_DOWN &amp;&amp; action == GLFW_RELEASE)</div>
<div class="line">     downkey = false;</div>
<div class="line">if (key == GLFW_KEY_UP &amp;&amp; action == GLFW_RELEASE)</div>
<div class="line">     upkey = false;</div>
<div class="line">if (key == GLFW_KEY_LEFT &amp;&amp; action == GLFW_RELEASE)</div>
<div class="line">     leftkey = false;</div>
<div class="line">if (key == GLFW_KEY_RIGHT &amp;&amp; action == GLFW_RELEASE)</div>
<div class="line">     rightkey = false;</div>
<div class="line">if (key == GLFW_KEY_ESCAPE &amp;&amp; action == GLFW_RELEASE)</div>
<div class="line">     esckey = false;</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><p>And finally, we go to the main program, and we create the renderer. The renderer is a singleton, so it can only be retrieved via the getInstance method, and assigned to a pointer:</p>
<div class="fragment"><div class="line">Renderer *renderer = &amp;Renderer::getInstance(&quot;Ball demo&quot;);</div>
</div><!-- fragment --><p>We will later need to access the window of the application, in order to pick up key events:</p>
<div class="fragment"><div class="line">GLFWwindow* window = renderer-&gt;getWindow();</div>
</div><!-- fragment --><p>We create the ball:</p>
<div class="fragment"><div class="line">SceneObject ball(&quot;ball&quot;, &quot;resources/ball.glb&quot;, &quot;&quot;);</div>
</div><!-- fragment --><p>small3d uses vectors a lot as parameters for convenience. When positioning the ball, the components are in order, x (-left, +right), y(+up, -down), and z (-away from the camera, +towards the camera):</p>
<div class="fragment"><div class="line">ball.position = glm::vec3(0.0f, -1.0f, -8.0f);</div>
</div><!-- fragment --><p>So let's start our main loop now. small3d uses GLFW and you can use it too! First we need to declare the callback function, which will be the keyCallback method we wrote above.</p>
<div class="fragment"><div class="line">glfwSetKeyCallback(window, keyCallback);</div>
</div><!-- fragment --><p>Now in every iteration, we need to check whether we want to exit the program. Let's say that we'll be doing that with the Esc key:</p>
<div class="fragment"><div class="line">while (!glfwWindowShouldClose(window) &amp;&amp; !esckey) {</div>
<div class="line"> </div>
<div class="line">glfwPollEvents();</div>
<div class="line"> if (esckey)</div>
<div class="line">  break;</div>
<div class="line">If after that we are still in the loop (so, no Esc key pressed), we will want to move the ball around with the keyboard.</div>
<div class="line">We will have the up arrow move the ball away from the camera. Down will do the opposite. Left and right move the ball as implied.</div>
<div class="line">if (upkey)</div>
<div class="line">  ball.position.z -= 0.001f;</div>
<div class="line">else if (downkey)</div>
<div class="line">  ball.position.z += 0.001f;</div>
<div class="line">else if (leftkey)</div>
<div class="line">  ball.position.x -= 0.001f;</div>
<div class="line">else if (rightkey)</div>
<div class="line">  ball.position.x += 0.001f;</div>
</div><!-- fragment --><p>Ok, the ball is positioned. Now we need to actually render it. The second parameter is the colour. Let's say it's yellow (the vector below symbolises an rgb colour, together with the alpha channel):</p>
<div class="fragment"><div class="line">renderer-&gt;render(ball, glm::vec4(1.0f, 1.0f, 0.0f, 1.0f));</div>
</div><!-- fragment --><p>We are using a buffered system (we draw on one buffer, while the user is looking at the other one), so we also need to swap the buffers:</p>
<div class="fragment"><div class="line">renderer-&gt;swapBuffers();</div>
</div><!-- fragment --><p>And we close the loop :)</p>
<div class="fragment"><div class="line">}</div>
</div><!-- fragment --><p>That's it!</p>
<p>Let's try it out. Create a ball/deps directory and from the built small3d library copy the cmake, build/include, build/lib and build/shaders directories to this deps directory. Then, back from the root ball directory execute:</p>
<div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake ..</div>
<div class="line">cmake --build .</div>
<div class="line">cd bin</div>
<div class="line">./ball</div>
</div><!-- fragment --><p>On Windows, you need to execute cmake .. -G"MinGW Makefiles", or with the preferred Visual Studio configuration (e.g. cmake .. -G"Visual Studio 17 2022").</p>
<p>On some platforms where the C++ '14 (at least) standard is not supported by default (this is the case on MacOS for example), in order to avoid compilation errors, you need to pass it to cmake: </p><pre class="fragment">cmake .. -DCMAKE_CXX_STANDARD=14
</pre><p>Note that you have to be inside the build/bin directory in order to execute the program, otherwise it will not find the necessary resource files (shaders, textures, etc).</p>
<p>There's our ball:</p>
<p><img src="tutorial08.png" alt="" class="inline" title="ball"/>   </p>
<p>Try moving it around with the arrows. small3d supports a lot more features than those presented here, playing sounds, collision detection and building with the conan build system which is a lot faster and easier than plain cmake. A good way to learn about all that is to read the documentation and also to explore the source code of the sample games. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
